<!DOCTYPE html>
<html>
<body>

<canvas id = "ctx" width="640" height="480" style="border:1px solid #000000;"></canvas>

<script>
// Variable declarations
var mouse = {
   x:undefined,
   y:undefined
}
// Coordinates for placing the cards
var cardGrid = {
  cardWidth:80,
  cardLength:120,
  col1x:25,
  col2x:125,
  col3x:225,
  col4x:325,
  col5x:425,
  row1y:50,
  row2y:190,
  row3y:330,
  padxy:2,
  padwl:4,
  padx:15,
  pos1:35,
  pos2:45,
  pos3:65,
  pos4:80,
  pos5:95
};
//  Hit box logic	
var selected = {
  card1:false,
  card2:false,
  card3:false,
  card4:false,
  card5:false,
  card6:false,
  card7:false,
  card8:false,
  card9:false,
  card10:false,
  card11:false,
  card12:false,
  card13:false,
  card14:false,
  card15:false,
  full:0
};

var displayed = {
  card1: true,
  card2: true,
  card3: true,
  card4: true,
  card5: true,
  card6: true,
  card7: true,
  card8: true,
  card9: true,
  card10:true,
  card11:true,
  card12:true,
  card13:false,
  card14:false,
  card15:false,
};

var hint = {
  card1: false,
  card2: false,
  card3: false,
  card4: false,
  card5: false,
  card6: false,
  card7: false,
  card8: false,
  card9: false,
  card10:false,
  card11:false,
  card12:false,
  card13:false,
  card14:false,
  card15:false,
};

var uiElements = {
  bannerX:140,
  bannerY:10,
  bannerW:300,
  bannerL:25,
  bannerTextX:180,
  bannerTextY:27,
   
  quitButtonX:600,
  quitButtonY:10,
  quitButtonW:20,
  quitButtonL:20,
  quitButtonTextX:606,
  quitButtonTextY:25,
  
  submitButtonX:515,
  submitButtonY:250,
  submitButtonW:105,
  submitButtonL:50,
  submitButtonTextX:545,
  submitButtonTextY:280,
   
  hintButtonX:515,
  hintButtonY:325,
  hintButtonW:105,
  hintButtonL:50,
  hintButtonTextX:555,
  hintButtonTextY:355,
  
  clearSelectionButtonX:515,
  clearSelectionButtonY:400,
  clearSelectionButtonW:105,
  clearSelectionButtonL:50,
  clearSelectionButtonTextX:520,
  clearSelectionButtonTextY:430,
  
  pad:5

};
// End Variable declaration

// Begin Functions	
window.addEventListener("click", function(event) {
  mouse.x = event.x,        
  mouse.y = event.y
  var width = 80;
  var length = 120;	
  
  hintButton(mouse.x, mouse.y);
  quitButton(mouse.x, mouse.y);
  clearSelectionButton(mouse.x, mouse.y);
  submitButton(mouse.x, mouse.y, playSurface);
   
  whichCards(mouse.x, mouse.y, width, length);	    	
  //if there is a click fire off all these functions which represent all off the selectable
  // elements in the game
    cardOne();
  cardTwo();	
  cardThree();	
  cardFour();
  cardFive();
  cardSix();
  cardSeven();
  cardEight();
  cardNine();
  cardTen();
  cardEleven();
  cardTwelve();
  if (playSurface.length === 15) {
		cardThirteen();
		cardFourteen();
		cardFifteen();
  };
  
});
 
// creating a deck of cards based on these four different characteristics or suits.

//LoadImages

createDeck = function () {

  var symbol = [ "diamond", "squiggle", "oval"];
  var color = [ "red", "green", "purple"];
  var shading = [ "solid", "striped", "open"];
  var quantity = [ 1, 2, 3];

// needed for each of the loops.  Each for loop is like a power multiplier  in this case 3 to the 4th power or 81 loops
// Leaving these in and commented out as I will be porting this to other scripting languages.
//var i = 0;  For the symbols on the card
//var j = 0;  For the color of the symbols on the card
//var k = 0;  For the shading of the symbols on the card
//var l = 0;  For the quantity of symbols on the card

//  Creating the deck <Start> ------------------------------------------------------------
// deck array
  var deck = [];
  var m = 0;  

//  looping structure to create the deck of cards
  for (let i = 0; i < symbol.length; i++) {
    for (let j = 0; j < color.length; j++) { 
      for (let k = 0; k < shading.length; k++) {
        for (let l = 0; l < quantity.length; l++) {
          deck[m] = {symbol: symbol[i], color:color[j], shading: shading[k], quantity: quantity[l], cardID : m+1, hint:false, displayed:false, slot:0, selected:false}; 
					// DEBUG output to make sure this works
					//console.log((m+1) + " " + symbol[i] + " and " + color[j] + " and " + shading[k] + " and " + quantity[l]);
					//console.log((m+1) + " " + deck[m].symbol + ", "+ deck[m].color + ", "+ deck[m].shading + ", "+ deck[m].quantity);
		  		m++;
				}
	  	}
    }
  }

  return deck;
};

shuffleDeck = function (deckMaster) {
  let shuffled = deckMaster.slice(0);
  var j, x, i;
  for (i = shuffled.length - 1; i > 0; i--) {
    j = Math.floor(Math.random() * (i + 1));
    x = shuffled[i];
    shuffled[i] = shuffled[j];
    shuffled[j] = x;
  }
  return shuffled;
}


createTable = function (playDeck) {
  //create initial table plateau of 12 dealt cards
  var plateau = [];
	
  for ( let cards = 0; cards < 12; cards++) {
		plateau[cards] = playDeck.pop();
		plateau[cards].slot = cards;
  };
  return plateau;
};


// noMatch is used when creating a new playsurface
//isMatch is used when determining if the three selected and submitted cards are a match 
noMatch = function (playSurface) {
  // clearing the hint data
  for (let i=1; i<16; i++){
    let clearHints = "card" + (i);
	hint[clearHints] = false;
  }
  // complicated nesting for loops to find matches	  
  for (let i = 0; i < (playSurface.length - 2); i++) {
		for (let j = i+1; j < (playSurface.length - 1); j++) {
	  	for (let k = j+1; k < playSurface.length; k++) {
	   		symbolMatched = 0;
				colorMatched = 0;
				shadingMatched = 0;
				quantityMatched = 0;
				weHaveASet = 0;
	    		    		
	    	// Are the symbols all the same or all different?
				if (playSurface[i].symbol === playSurface[j].symbol && playSurface[i].symbol === playSurface[k].symbol) {
		  		symbolMatched = 1;
				} else if ((playSurface[i].symbol !== playSurface[j].symbol) && (playSurface[i].symbol !== playSurface[k].symbol) && (playSurface[j].symbol !== playSurface[k].symbol)) {
					symbolMatched = 1;
				} else { 
			  	symbolMatched = 0;
				}
				// Now check the colors		
				if (playSurface[i].color === playSurface[j].color && playSurface[i].color === playSurface[k].color) {
		  		colorMatched = 1;
				} else if ((playSurface[i].color !== playSurface[j].color) && (playSurface[i].color !== playSurface[k].color) && (playSurface[j].color !== playSurface[k].color)) {
					colorMatched = 1;
				} else { 
					colorMatched = 0;
				}
				// Now the check the shading
				if (playSurface[i].shading === playSurface[j].shading && playSurface[i].shading === playSurface[k].shading) {
		  		shadingMatched = 1;
				} else if ((playSurface[i].shading !== playSurface[j].shading) && (playSurface[i].shading !== playSurface[k].shading) && (playSurface[j].shading !== playSurface[k].shading)) {
					shadingMatched = 1;
				} else { 
					shadingMatched = 0;
				}
				// finally the quantity of symbols
				if (playSurface[i].quantity === playSurface[j].quantity && playSurface[i].quantity === playSurface[k].quantity) {
		  		quantityMatched = 1;
				} else if ((playSurface[i].quantity !== playSurface[j].quantity) && (playSurface[i].quantity !== playSurface[k].quantity) && (playSurface[j].quantity !== playSurface[k].quantity)) {
					quantityMatched = 1;
				} else { 
					quantityMatched = 0;
				}
				// Now checking if we have a set
				if (4 === (symbolMatched + colorMatched + shadingMatched + quantityMatched)) {
		  		weHaveASet = 1;
		  	// saving the set for the hint buttons.
		  		let resultI = "card" + (i + 1);
		  		let resultJ = "card" + (j + 1);
		  		let resultK = "card" + (k + 1);
		  		hint[resultI] = true;
		  		hint[resultJ] = true;
		  		hint[resultK] = true;
		  		// DEBUG code
		  		//console.log(hint.card1 + " " + hint.card2 + " " + hint.card3 + " " + hint.card4 + " " + hint.card5 + " " + hint.card6 + " " + hint.card7 + " " + hint.card8 + " " + hint.card9 + " " + hint.card10 + " " + hint.card11 + " " + hint.card12);
		  		//console.log ( " \n\nWe have a Set!!: i = " + i + " j = " + j + " k = " + k + " symbol: " + symbolMatched + " color: " + colorMatched + " shading: " + shadingMatched + " quantity: " + quantityMatched + "\n");
		  		//console.log((1) + " " + playSurface[i].symbol + ", "+ playSurface[i].color + ", "+ playSurface[i].shading + ", "+ playSurface[i].quantity);
		  		//console.log((2) + " " + playSurface[j].symbol + ", "+ playSurface[j].color + ", "+ playSurface[j].shading + ", "+ playSurface[j].quantity);
		  		//console.log((3) + " " + playSurface[k].symbol + ", "+ playSurface[k].color + ", "+ playSurface[k].shading + ", "+ playSurface[k].quantity);
	      	// if we have a set then no need to do anything else.  Break out of this loop.
		  		return weHaveASet;
				} else {
					weHaveASet = 0;
					//DEBUG code
					//console.log("nope");
					//console.log ( " \nNo Set: i = " + i + " j = " + j + " k = " + k + " symbol: " + symbolMatched + " color: " + colorMatched + " shading: " + shadingMatched + " quantity: " + quantityMatched);
					//console.log((1) + " " + playSurface[i].symbol + ", "+ playSurface[i].color + ", "+ playSurface[i].shading + ", "+ playSurface[i].quantity);
					//console.log((2) + " " + playSurface[j].symbol + ", "+ playSurface[j].color + ", "+ playSurface[j].shading + ", "+ playSurface[j].quantity);
					//console.log((3) + " " + playSurface[k].symbol + ", "+ playSurface[k].color + ", "+ playSurface[k].shading + ", "+ playSurface[k].quantity);
				};
	  	}; // end of k for loop
		}; // end of j for loop
  }; // end of i for loop
  return weHaveASet;
}; //end of the function

//isMatch

isMatch = function (submitted) {
  // clearing the hint data
  // complicated nesting for loops to find matches	  
  for (let i = 0; i < (submitted.length - 2); i++) {
		for (let j = i+1; j < (submitted.length - 1); j++) {
	  	for (let k = j+1; k < submitted.length; k++) {
	   		symbolMatched = 0;
				colorMatched = 0;
				shadingMatched = 0;
				quantityMatched = 0;
				weHaveASet = 0;
	    	// Are the symbols all the same or all different?
				if (submitted[i].symbol === submitted[j].symbol && submitted[i].symbol === submitted[k].symbol) {
		  		symbolMatched = 1;
				} else if ((submitted[i].symbol !== submitted[j].symbol) && (submitted[i].symbol !== submitted[k].symbol) && (submitted[j].symbol !== submitted[k].symbol)) {
					symbolMatched = 1;
				} else { 
			  	symbolMatched = 0;
				}
				// Now check the colors		
				if (submitted[i].color === submitted[j].color && submitted[i].color === submitted[k].color) {
		  		colorMatched = 1;
				} else if ((submitted[i].color !== submitted[j].color) && (submitted[i].color !== submitted[k].color) && (submitted[j].color !== submitted[k].color)) {
					colorMatched = 1;
				} else { 
					colorMatched = 0;
				}
				// Now the check the shading
				if (submitted[i].shading === submitted[j].shading && submitted[i].shading === submitted[k].shading) {
		  		shadingMatched = 1;
				} else if ((submitted[i].shading !== submitted[j].shading) && (submitted[i].shading !== submitted[k].shading) && (submitted[j].shading !== submitted[k].shading)) {
					shadingMatched = 1;
				} else { 
					shadingMatched = 0;
				}
				// finally the quantity of symbols
				if (submitted[i].quantity === submitted[j].quantity && submitted[i].quantity === submitted[k].quantity) {
		  		quantityMatched = 1;
				} else if ((submitted[i].quantity !== submitted[j].quantity) && (submitted[i].quantity !== submitted[k].quantity) && (submitted[j].quantity !== submitted[k].quantity)) {
					quantityMatched = 1;
				} else { 
					quantityMatched = 0;
				}
				// Now checking if we have a set
				if (4 === (symbolMatched + colorMatched + shadingMatched + quantityMatched)) {
		  		weHaveASet = 1;
		  		//clearhints and selections
		  		for (let i=1; i<16; i++){
    				let clearHints = "card" + (i);
						hint[clearHints] = false;
						selected[clearHints] = false;
  					selected.full = 0;
  				};
					dealCards(submitted);
					console.log("Score");
					continueGame();
					refreshScreen();
				
 		  		} else {
						weHaveASet = 0;
						//flash the submit button
						flashSubmitButton();
				  };
	  	}; // end of k for loop
		}; // end of j for loop
  }; // end of i for loop
  return weHaveASet;
}; //end of the function

flashSubmitButton = function () {
  var CTX = document.getElementById("ctx").getContext("2d");
	CTX.beginPath();
  CTX.strokeStyle="Red";
  CTX.lineWidth=6;
  CTX.rect(uiElements.submitButtonX, uiElements.submitButtonY, uiElements.submitButtonW, uiElements.submitButtonL);
  CTX.stroke();
  CTX.closePath();
  CTX.beginPath();
  CTX.strokeStyle="Blue";
  CTX.lineWidth=6;
  CTX.rect(uiElements.submitButtonX, uiElements.submitButtonY, uiElements.submitButtonW, uiElements.submitButtonL);
  CTX.fillText("Submit", uiElements.submitButtonTextX, uiElements.submitButtonTextY);
  CTX.stroke();
  CTX.closePath();
};


dealCards = function(submitted) {
	// Setting variables
	let slot1 = submitted[0].slot;				
	let slot2 = submitted[1].slot;
	let slot3 = submitted[2].slot;

	console.log("slot 1:" + slot1 + " slot 2:" + slot2 + " slot 3:" + slot3 );
	//changing the cards from the ones submitted to ones from the deck
	playSurface[slot1] = playDeck.pop();
	playSurface[slot1].slot = slot1;
	 
	playSurface[slot2] = playDeck.pop();
	playSurface[slot2].slot = slot2;
	
	playSurface[slot3] = playDeck.pop();
	playSurface[slot3].slot = slot3;
};
	
startGame = function (playSurface, playDeck){
  var noSets = noMatch(playSurface);
  let i = 0;
  console.log("Game Started");
	while (noSets === 0) {
    //masterDeck = createDeck();
			for (let cards = 69; cards < 81; cards++) {
				playDeck[cards]	= playSurface.pop();
				playDeck[cards].slot = -1;
			//	console.log("Table cards: " + playSurface.length + " Deck cards:" + playDeck.length);
			}	
		playDeck = shuffleDeck(playDeck);
		playSurface = createTable(playDeck);
		noSets = noMatch(playSurface);
		i = i+1;
		console.log(noSets + " redeal " + i);		
  };
  
return playSurface;	
};

continueGame = function (){
  var noSets = noMatch(playSurface);
  let i = 0;
  console.log("New cards ");
	if (playDeck.length !== 0) {
		while (noSets === 0) {
    	let limiter = playDeck.length
    	console.log("limiter = " + limiter);
    	for (let cards = 0; cards < limiter; cards++) {
				playDeck[cards]	= playSurface.pop();
				playDeck[cards].slot = -1;
			}	
			playDeck = shuffleDeck(playDeck);
			playSurface = createTable(playDeck);
			noSets = noMatch(playSurface);
			i = i+1;
			console.log(noSets + " redeal " + i);		
  	}
  } else {
  		endGame();
  }
  return;	
};

endGame = function () {
		
	for (let i=1; i<16; i++){
    let endgame = "card" + (i);
		hint[endgame] = false;
		selected[endgame] = false;
  	selected.full = 0;
  	displayed[endgame] = false;
  };
	let CTXG = document.getElementById("ctx").getContext("2d");
 	CTXG.beginPath();
  CTXG.clearRect(20, 45, 480, 480);
  CTXG.stroke();
  CTXG.closePath();
  CTXG.beginPath();
  CTXG.fillRect(20, 45, 480, 480);
  CTXG.font="30px Arial";
  CTXG.fillStyle = "white";
  CTXG.fillText("GAME OVER!!",150,100 );
  CTXG.stroke();
  CTXG.fillStyle = "black";
  CTXG.closePath();
};
	
drawCards = function (playSurface) {
  for (let i = 0; i < playSurface.length; i++) {
	createCard(playSurface);
  };	
};	

drawBanner = function () {
  var CTXG = document.getElementById("ctx").getContext("2d");
  //the instruction banner
  CTXG.beginPath();
  CTXG.strokeStyle="Purple";
  CTXG.lineWidth=4;
  CTXG.rect(uiElements.bannerX, uiElements.bannerY, uiElements.bannerW, uiElements.bannerL);
  CTXG.font="14px Arial";
  CTXG.fillText("Select Three Cards that make a Set", uiElements.bannerTextX, uiElements.bannerTextY);
  CTXG.stroke();
  CTXG.closePath();
};

createGameUI = function (){
  // create the game screen elements
  var CTXG = document.getElementById("ctx").getContext("2d");
  //the instruction banner
  drawBanner();
  
  CTXG.beginPath();
  CTXG.strokeStyle="Purple";
  CTXG.lineWidth=4;
  CTXG.rect(uiElements.bannerX, uiElements.bannerY, uiElements.bannerW, uiElements.bannerL);
  CTXG.fillText("Select Three Cards that make a Set", uiElements.bannerTextX, uiElements.bannerTextY);
  CTXG.stroke();
  CTXG.closePath();

//Quit button
  CTXG.beginPath();
  CTXG.strokeStyle="Red";
  CTXG.lineWidth=6;
  CTXG.rect(uiElements.quitButtonX, uiElements.quitButtonY, uiElements.quitButtonW, uiElements.quitButtonL);
  CTXG.fillText("X", uiElements.quitButtonTextX, uiElements.quitButtonTextY);
  CTXG.stroke();
  CTXG.closePath();

//Deck graphic
  drawDeck();
  
//Submit button
  CTXG.beginPath();
  CTXG.strokeStyle="Blue";
  CTXG.lineWidth=6;
  CTXG.rect(uiElements.submitButtonX, uiElements.submitButtonY, uiElements.submitButtonW, uiElements.submitButtonL);
  CTXG.fillText("Submit", uiElements.submitButtonTextX, uiElements.submitButtonTextY);
  CTXG.stroke();
  CTXG.closePath();
	
//Hint button
  CTXG.beginPath();
  CTXG.lineWidth=6;
  CTXG.rect(uiElements.hintButtonX,uiElements.hintButtonY, uiElements.hintButtonW, uiElements.hintButtonL);
  CTXG.fillText("Hint", uiElements.hintButtonTextX, uiElements.hintButtonTextY);
  CTXG.stroke();
  CTXG.closePath();

//clearSelection button
  CTXG.beginPath();
  CTXG.lineWidth=6;
  CTXG.rect(uiElements.clearSelectionButtonX,uiElements.clearSelectionButtonY, uiElements.clearSelectionButtonW, uiElements.clearSelectionButtonL);
  CTXG.fillText("Clear Selection", uiElements.clearSelectionButtonTextX, uiElements.clearSelectionButtonTextY);
  CTXG.stroke();
  CTXG.closePath();

};

drawDeck = function () {
  var XG = document.getElementById("ctx").getContext("2d");

	XG.beginPath();
  XG.fillRect(530, 88, 80 , 120);
  XG.clearRect(532, 90, 76 , 116);
  XG.fillRect(524, 94, 80 , 120);
  XG.clearRect(526, 96, 76 , 116);
  XG.fillRect(518, 100, 80 , 120);
  XG.clearRect(520, 102, 76 , 116);
  XG.font="14px Arial";
  XG.fillText("Draw Deck", 525, 140);
  XG.fillText("Cards Left:", 525, 160);
  XG.fillStyle = 'red';
  XG.font="24px Arial";
  XG.fillText(playDeck.length, 545, 200); 
  XG.stroke();
  XG.font="14px Arial";
  XG.fillStyle = "black";
  XG.closePath();
};
 
 
quitButton = function (x,y) {
  if ((x >= uiElements.quitButtonX - uiElements.pad && x <= (uiElements.quitButtonX + uiElements.quitButtonW + (uiElements.pad * 2))) && (y >= uiElements.quitButtonY - uiElements.pad && y <= (uiElements.quitButtonY + uiElements.quitButtonL + (uiElements.pad * 2)))) {
	location.reload(true);	
  endGame();
  }
};

submitButton = function (x,y, playSurface) {
  if ((x >= uiElements.submitButtonX - uiElements.pad && x <= uiElements.submitButtonX + uiElements.submitButtonW + (uiElements.pad * 2)) && (y >= uiElements.submitButtonY - uiElements.pad && y <= uiElements.submitButtonY + uiElements.submitButtonL + (uiElements.pad * 2))) {
		console.log("submitButton");
		if (selected.full === 3) {
			var submitted = [];
			let j = 0;
			for(let i = 1; i < 13; i++) {
				let count = "card" + i;
				if (selected[count] === true) {
					console.log (i-1);
					submitted[j] = playSurface[i-1];
					j++;
				}
			}
			console.log("submitted");
			//Is Match function
			isMatch(submitted);
			refreshScreen();
		} else {
				console.log("Please Select Three cards");
		}
	}
};

hintButton = function (x,y) {
  if ((x >= uiElements.hintButtonX - uiElements.pad && x <= uiElements.hintButtonX + uiElements.hintButtonW + (uiElements.pad * 2)) && (y >= uiElements.hintButtonY - uiElements.pad && y <= uiElements.hintButtonY + uiElements.hintButtonL + (uiElements.pad * 2))) {
		console.log("hintButton");
		let gatekeeper = 0;
		for (let i=1; i<16; i++){
    	let hints = "card" + (i);
			if (hint[hints] === true) {
				console.log(hints + ":" + hint[hints]);
				while (gatekeeper === 0) {
					flashHint(i);
					gatekeeper = 1;
				}	
			}
  	}
  }
};

flashHint = function(cardNumber) {
	switch(cardNumber) {
    case 1:
        console.log("cardOne");
        break;
    case 2:
        console.log("cardTwo");
        break;
		case 3:
        console.log("cardThree");
        break;
    case 4:
        console.log("cardFour");
        break;
		case 5:
        console.log("cardFive");
        break;
    case 6:
        console.log("cardSix");
        break;
		case 7:
        console.log("cardSeven");
        break;
    case 8:
        console.log("cadrEight");
        break;
		case 9:
        console.log("cardNine");
        break;
    case 10:
        console.log("cardTen");
        break;
		case 11:
        console.log("cardEleven");
        break;
    case 12:
        console.log("cardTwelve");
        break;
		case 13:
        console.log("cardThirteen");
        break;
    case 14:
        console.log("cardFourteen");
        break;
		case 15:
        console.log("cardFifteen");
        break;
	}
};

clearSelectionButton = function (x,y) {
  if ((x >= uiElements.clearSelectionButtonX - uiElements.pad && x <= uiElements.clearSelectionButtonX + uiElements.clearSelectionButtonW + (uiElements.pad * 2)) && (y >= uiElements.clearSelectionButtonY - uiElements.pad && y <= uiElements.clearSelectionButtonY + uiElements.clearSelectionButtonL + (uiElements.pad * 2))) {
		console.log("clearSelectionButton");
		for (let i=1; i<16; i++){
    				let clearSelections = "card" + (i);
						selected[clearSelections] = false;
  					selected.full = 0;
		}
  	refreshScreen();
  }
};

//What image should I use?
// this checks the card's data and loads the right image based on that data  
displayGraphic = function (playSurface, i) {
  var cardImage = "";

  if ( playSurface[i].color === "red" && playSurface[i].symbol === "diamond" && playSurface[i].shading === "solid") {
	cardImage = "resources/RedDiamondSolid.jpg";
	return cardImage;	
  } else if ( playSurface[i].color === "red" && playSurface[i].symbol === "diamond" && playSurface[i].shading === "striped") {
	  cardImage = "resources/RedDiamondStriped.jpg";
	  return cardImage;	
  } else if ( playSurface[i].color === "red" && playSurface[i].symbol === "diamond" && playSurface[i].shading === "open") {
	  cardImage = "resources/RedDiamondOpen.jpg";
	  return cardImage;	
  } else if ( playSurface[i].color === "red" && playSurface[i].symbol === "squiggle" && playSurface[i].shading === "solid") {
	  cardImage = "resources/RedSquiggleSolid.jpg";
	  return cardImage;	
  } else if ( playSurface[i].color === "red" && playSurface[i].symbol === "squiggle" && playSurface[i].shading === "striped") {
	  cardImage = "resources/RedSquiggleStriped.jpg";
	  return cardImage;	
  } else if ( playSurface[i].color === "red" && playSurface[i].symbol === "squiggle" && playSurface[i].shading === "open") {
	  cardImage = "resources/RedSquiggleOpen.jpg";
	  return cardImage;	
  } else if ( playSurface[i].color === "red" && playSurface[i].symbol === "oval" && playSurface[i].shading === "solid") {
	  cardImage = "resources/RedOvalSolid.jpg";
	  return cardImage;	
  } else if ( playSurface[i].color === "red" && playSurface[i].symbol === "oval" && playSurface[i].shading === "striped") {
	  cardImage = "resources/RedOvalStriped.jpg";
	  return cardImage;	
  } else if ( playSurface[i].color === "red" && playSurface[i].symbol === "oval" && playSurface[i].shading === "open") {
	  cardImage = "resources/RedOvalOpen.jpg";
	  return cardImage;	
  } else if ( playSurface[i].color === "green" && playSurface[i].symbol === "diamond" && playSurface[i].shading === "solid") {
	  cardImage = "resources/GreenDiamondSolid.jpg";
	  return cardImage;	
  } else if ( playSurface[i].color === "green" && playSurface[i].symbol === "diamond" && playSurface[i].shading === "striped") {
	  cardImage = "resources/GreenDiamondStriped.jpg";
	  return cardImage;	
  } else if ( playSurface[i].color === "green" && playSurface[i].symbol === "diamond" && playSurface[i].shading === "open") {
	  cardImage = "resources/GreenDiamondOpen.jpg";
	  return cardImage;	
  } else if ( playSurface[i].color === "green" && playSurface[i].symbol === "squiggle" && playSurface[i].shading === "solid") {
	  cardImage = "resources/GreenSquiggleSolid.jpg";
	  return cardImage;	
  } else if ( playSurface[i].color === "green" && playSurface[i].symbol === "squiggle" && playSurface[i].shading === "striped") {
	  cardImage = "resources/GreenSquiggleStriped.jpg";
	  return cardImage;	
  } else if ( playSurface[i].color === "green" && playSurface[i].symbol === "squiggle" && playSurface[i].shading === "open") {
	  cardImage = "resources/GreenSquiggleOpen.jpg";
	  return cardImage;	
  } else if ( playSurface[i].color === "green" && playSurface[i].symbol === "oval" && playSurface[i].shading === "solid") {
	  cardImage = "resources/GreenOvalSolid.jpg";
	  return cardImage;	
  } else if ( playSurface[i].color === "green" && playSurface[i].symbol === "oval" && playSurface[i].shading === "striped") {
	  cardImage = "resources/GreenOvalStriped.jpg";
	  return cardImage;	
  } else if ( playSurface[i].color === "green" && playSurface[i].symbol === "oval" && playSurface[i].shading === "open") {
	  cardImage = "resources/GreenOvalOpen.jpg";
	  return cardImage;	
  } else if ( playSurface[i].color === "purple" && playSurface[i].symbol === "diamond" && playSurface[i].shading === "solid") {
	  cardImage = "resources/PurpleDiamondSolid.jpg";
	  return cardImage;	
  } else if ( playSurface[i].color === "purple" && playSurface[i].symbol === "diamond" && playSurface[i].shading === "striped") {
	  cardImage = "resources/PurpleDiamondStriped.jpg";
	  return cardImage;	
  } else if ( playSurface[i].color === "purple" && playSurface[i].symbol === "diamond" && playSurface[i].shading === "open") {
	  cardImage = "resources/PurpleDiamondOpen.jpg";
	  return cardImage;	
  } else if ( playSurface[i].color === "purple" && playSurface[i].symbol === "squiggle" && playSurface[i].shading === "solid") {
	  cardImage = "resources/PurpleSquiggleSolid.jpg";
	  return cardImage;	
  } else if ( playSurface[i].color === "purple" && playSurface[i].symbol === "squiggle" && playSurface[i].shading === "striped") {
	  cardImage = "resources/PurpleSquiggleStriped.jpg";
	  return cardImage;	
  } else if ( playSurface[i].color === "purple" && playSurface[i].symbol === "squiggle" && playSurface[i].shading === "open") {
	  cardImage = "resources/PurpleSquiggleOpen.jpg";
	  return cardImage;	
  } else if ( playSurface[i].color === "purple" && playSurface[i].symbol === "oval" && playSurface[i].shading === "solid") {
	  cardImage = "resources/PurpleOvalSolid.jpg";
	  return cardImage;	
  } else if ( playSurface[i].color === "purple" && playSurface[i].symbol === "oval" && playSurface[i].shading === "striped") {
	  cardImage = "resources/PurpleOvalStriped.jpg";
	  return cardImage;	
  } else if ( playSurface[i].color === "purple" && playSurface[i].symbol === "oval" && playSurface[i].shading === "open") {
	  cardImage = "resources/PurpleOvalOpen.jpg";
	  return cardImage;	
  };
};

//Determining which cards are selected.
whichCards = function(x,y,cardW,cardL,full){
	
  if (((x >= cardGrid.col1x && x <= cardGrid.col1x + cardW) && (y >= cardGrid.row1y && y <= cardGrid.row1y + cardL)) && displayed.card1 === true) {
		console.log("card1");
		if (selected.card1 === false && selected.full < 3) {
	  	selected.card1 = true;
	  	selected.full = selected.full + 1;
		} else if (selected.card1 === true){
	    	selected.card1 = false;
	    	selected.full = selected.full - 1;
		} 
  } else if (((x >= cardGrid.col1x && x <= cardGrid.col1x + cardW) && (y >= cardGrid.row2y && y <= cardGrid.row2y + cardL)) && displayed.card2 === true) {
	  	console.log("card2");
	  	if (selected.card2 === false && selected.full < 3) {
	    	selected.card2 = true;
	    	selected.full = selected.full + 1;
	  	} else if (selected.card2 === true) {
	  		  selected.card2 = false;
	  		  selected.full = selected.full - 1;
	  	}  
  } else if (((x >= cardGrid.col1x && x <= cardGrid.col1x + cardW) && (y >= cardGrid.row3y && y <= cardGrid.row3y + cardL)) && displayed.card3 === true) {
	  	console.log("card3");
	  	if (selected.card3 === false && selected.full < 3) {
	    	selected.card3 = true;
	    	selected.full = selected.full + 1;
	  	} else if (selected.card3 === true) {
	  		  selected.card3 = false;
	  		  selected.full = selected.full - 1;
	 		}  
  } else if (((x >= cardGrid.col2x && x <= cardGrid.col2x + cardW) && (y >= cardGrid.row1y && y <= cardGrid.row1y + cardL)) && displayed.card4 === true) {
	 		console.log("card4");
	  	if (selected.card4 === false && selected.full < 3) {
	    	selected.card4 = true;
	    	selected.full = selected.full + 1;
	  	} else if (selected.card4 === true) {
	  	  	selected.card4 = false;
	  	  	selected.full = selected.full - 1;
	  	}  
  } else if (((x >= cardGrid.col2x && x <= cardGrid.col2x + cardW) && (y >= cardGrid.row2y && y <= cardGrid.row2y + cardL)) && displayed.card5 === true) {
	  	console.log("card5");
	  	if (selected.card5 === false && selected.full < 3) {
	    	selected.card5 = true;
	    	selected.full = selected.full + 1;
	  	} else if (selected.card5 === true) {
	  		  selected.card5 = false;
	  		  selected.full = selected.full - 1;
	  	}  
  } else if (((x >= cardGrid.col2x && x <= cardGrid.col2x + cardW) && (y >= cardGrid.row3y && y <= cardGrid.row3y + cardL)) && displayed.card6 === true) {
	  	console.log("card6");
	  	if (selected.card6 === false && selected.full < 3) {
	    	selected.card6 = true;
	    	selected.full = selected.full + 1;
	  	} else if (selected.card6 === true) {
	  	  	selected.card6 = false;
	  	  	selected.full = selected.full - 1;
	  	}  
  } else if (((x >= cardGrid.col3x && x <= cardGrid.col3x + cardW) && (y >= cardGrid.row1y && y <= cardGrid.row1y + cardL)) && displayed.card7 === true) {
	  	console.log("card7");
	  	if (selected.card7 === false && selected.full < 3) {
	    	selected.card7 = true;
	    	selected.full = selected.full + 1;
	  	} else if (selected.card7 === true) {
	  	  	selected.card7 = false;
	  	  	selected.full = selected.full - 1;
	  	}  
  } else if (((x >= cardGrid.col3x && x <= cardGrid.col3x + cardW) && (y >= cardGrid.row2y && y <= cardGrid.row2y + cardL)) && displayed.card8 === true) {
	  	console.log("card8");
	  	if (selected.card8 === false && selected.full < 3) {
	    	selected.card8 = true;
	    	selected.full = selected.full + 1;
	  	} else if (selected.card8 === true) {
		  		selected.card8 = false;
		  		selected.full = selected.full - 1;
	  	}  
  } else if (((x >= cardGrid.col3x && x <= cardGrid.col3x + cardW) && (y >= cardGrid.row3y && y <= cardGrid.row3y + cardL)) && displayed.card9 === true) {
	  	console.log("card9");
	  	if (selected.card9 === false && selected.full < 3) {
	    	selected.card9 = true;
	    	selected.full = selected.full + 1;
	  	} else if (selected.card9 === true) {
	  	  	selected.card9 = false;
	  	  	selected.full = selected.full - 1;
	  	}  
  } else if (((x >= cardGrid.col4x && x <= cardGrid.col4x + cardW) && (y >= cardGrid.row1y && y <= cardGrid.row1y + cardL)) && displayed.card10 === true) {
	  	console.log("card10");
	  	if (selected.card10 === false && selected.full < 3) {
	    	selected.card10 = true;
	    	selected.full = selected.full + 1;
	  	} else if (selected.card10 === true) {
	  	  	selected.card10 = false;
	  	  	selected.full = selected.full - 1;
	  	}  
  } else if (((x >= cardGrid.col4x && x <= cardGrid.col4x + cardW) && (y >= cardGrid.row2y && y <= cardGrid.row2y + cardL)) && displayed.card11 === true)  {
	  	console.log("card11");
	  	if (selected.card11 === false && selected.full < 3) {
	    	selected.card11 = true;
	    	selected.full = selected.full + 1;
	  	} else if (selected.card11 === true) {
	  	  	selected.card11 = false;
	  	  	selected.full = selected.full - 1;
	  	}   
  } else if (((x >= cardGrid.col4x && x <= cardGrid.col4x + cardW) && (y >= cardGrid.row3y && y <= cardGrid.row3y + cardL)) && displayed.card12 === true)  {
	  	console.log("card12");
	  	if (selected.card12 === false && selected.full < 3) {
	    	selected.card12 = true;
	    	selected.full = selected.full + 1;
	  	} else if (selected.card12 === true) {
	  	  	selected.card12 = false;
	  	  	selected.full = selected.full - 1;
	  	}   
  } else if (((x >= cardGrid.col5x && x <= cardGrid.col5x + cardW) && (y >= cardGrid.row1y && y <= cardGrid.row1y + cardL)) && displayed.card13 === true)  {
	  	console.log("card13");
	  	if (selected.card13 === false && selected.full < 3) {
	    	selected.card13 = true;
	    	selected.full = selected.full + 1;
	  	} else if (selected.card13 === true) {
	  	  	selected.card13 = false;
	  	  	selected.full = selected.full - 1;
	  	}   
  } else if (((x >= cardGrid.col5x && x <= cardGrid.col5x + cardW) && (y >= cardGrid.row2y && y <= cardGrid.row2y + cardL)) && displayed.card14 === true)  {
	  	console.log("card14");
	  	if (selected.card14 === false && selected.full < 3) {
	    	selected.card14 = true;
	    	selected.full = selected.full + 1;
	  	} else if (selected.card14 === true) {
	  	  	selected.card14 = false;
	  	  	selected.full = selected.full - 1;
	  	}   
  } else if (((x >= cardGrid.col5x && x <= cardGrid.col5x + cardW) && (y >= cardGrid.row3y && y <= cardGrid.row3y + cardL)) && displayed.card15 === true)  {
	  	console.log("card15");
	  	if (selected.card15 === false && selected.full < 3) {
	    	selected.card15 = true;
	    	selected.full = selected.full + 1;
	  	} else if (selected.card15 === true) {
	  	  	selected.card15 = false;
	  	  	selected.full = selected.full - 1;
	  	}  
  };
};
// hit box logic  Static values
// this varabile is declared also in the createCard function.  On of them should be removed

createCard = function (playSurface){
  var ctx = document.getElementById("ctx").getContext("2d");
 // Each of these functions is displaying on the screen the attributes of each card.		

  drawCardFrame = function(whichCard,x,y,w,l){
		let card = whichCard;
		if (card === true) {
	  	//set color to green	
	  	ctx.beginPath();
	  	ctx.strokeStyle="Green";
	  	ctx.lineWidth=10;
	  	ctx.strokeRect(x, y, w, l);
	  	ctx.stroke();
	  	ctx.closePath();
		} else {
				//set color to black
				ctx.beginPath();
				ctx.clearRect(x-5,y-5, w + 10, l+10);
				ctx.lineWidth=2;
				ctx.strokeStyle="#000000";
				ctx.strokeRect(x, y, w, l);
				ctx.stroke();
				ctx.closePath();
		};
  };
	
	
 //attempting to replace the if else statement in the cards for how many images ot display with this
 //function.
  numberOfShapes = function(shapes, images, x, y, cardWidth, cardLength,i) {
		cardImage = images;
		if (shapes === 1) {
	  	cardImage.onload = function() {  
				clearCard(x,y,cardWidth, cardLength);
				ctx.drawImage(images, x + cardWidth/2 - cardGrid.padx, y + cardGrid.pos3 - cardGrid.padx);
	  	};
	  images.src = displayGraphic(playSurface,i);
		} else if (shapes === 2) {
			cardImage.onload = function() {  
  			clearCard(x,y,cardWidth, cardLength);
		  	ctx.drawImage(images, x + cardWidth/2 - cardGrid.padx, y + cardGrid.pos2 - cardGrid.padx);
		  	ctx.drawImage(images, x + cardWidth/2 - cardGrid.padx, y + cardGrid.pos4 - cardGrid.padx);
			};
			images.src = displayGraphic(playSurface,i);
		} else {
			cardImage.onload = function() {  
				clearCard(x,y,cardWidth, cardLength);
		  	ctx.drawImage(images, x + cardWidth/2 - cardGrid.padx, y + cardGrid.pos1 - cardGrid.padx);
		  	ctx.drawImage(images, x + cardWidth/2 - cardGrid.padx, y + cardGrid.pos3 - cardGrid.padx);
		  	ctx.drawImage(images, x + cardWidth/2 - cardGrid.padx, y + cardGrid.pos5 - cardGrid.padx);
			};	
	   	images.src = displayGraphic(playSurface,i);
		};
  };
		
		
	clearCard = function (x,y,w,h) {
		ctx.clearRect(x+5,y+5,w-8,h-8);
		ctx.stroke();
	};		
		
// each of these cardX functions has 2 main parts
// 1. draw the card frame based on whether or not the card is selected or not.  
// 2. draw the correct images for the card data, such as two red filled ovals or one red open diamond		
  cardOne = function() {
		if (displayed.card1 === true) { 
			drawCardFrame(selected.card1, cardGrid.col1x, cardGrid.row1y, cardGrid.cardWidth, cardGrid.cardLength);
			let cardImage1 = new Image();
			numberOfShapes(playSurface[0].quantity, cardImage1, cardGrid.col1x, cardGrid.row1y, cardGrid.cardWidth, cardGrid.cardLength, 0);
		}
  };

  cardTwo = function() {
		if (displayed.card2 === true) { 
			drawCardFrame(selected.card2, cardGrid.col1x, cardGrid.row2y, cardGrid.cardWidth, cardGrid.cardLength);
			let cardImage2 = new Image();
			numberOfShapes(playSurface[1].quantity, cardImage2, cardGrid.col1x, cardGrid.row2y, cardGrid.cardWidth, cardGrid.cardLength, 1);
		}	
  };
	
  cardThree = function() {
		if (displayed.card3 === true) { 
			drawCardFrame(selected.card3, cardGrid.col1x, cardGrid.row3y, cardGrid.cardWidth, cardGrid.cardLength);
			let cardImage3 = new Image();
			numberOfShapes(playSurface[2].quantity, cardImage3, cardGrid.col1x, cardGrid.row3y, cardGrid.cardWidth, cardGrid.cardLength, 2);
		}
  };
		
  cardFour = function() {
		if (displayed.card4 === true) { 
			drawCardFrame(selected.card4, cardGrid.col2x, cardGrid.row1y, cardGrid.cardWidth, cardGrid.cardLength);
			let cardImage4 = new Image();
			numberOfShapes(playSurface[3].quantity, cardImage4, cardGrid.col2x, cardGrid.row1y, cardGrid.cardWidth, cardGrid.cardLength, 3);
		}			
	};
	
  cardFive = function() {
	  if (displayed.card5 === true) { 
			drawCardFrame(selected.card5, cardGrid.col2x, cardGrid.row2y, cardGrid.cardWidth, cardGrid.cardLength);
			let cardImage5 = new Image();
			numberOfShapes(playSurface[4].quantity, cardImage5, cardGrid.col2x, cardGrid.row2y, cardGrid.cardWidth, cardGrid.cardLength, 4);
		}
	};

  cardSix = function() {
		if (displayed.card6 === true) { 
			drawCardFrame(selected.card6, cardGrid.col2x, cardGrid.row3y, cardGrid.cardWidth, cardGrid.cardLength);
			let cardImage6 = new Image();
			numberOfShapes(playSurface[5].quantity, cardImage6, cardGrid.col2x, cardGrid.row3y, cardGrid.cardWidth, cardGrid.cardLength, 5);
		}
  };

  cardSeven = function() {
		if (displayed.card7 === true) { 
			drawCardFrame(selected.card7, cardGrid.col3x, cardGrid.row1y, cardGrid.cardWidth, cardGrid.cardLength);
			let cardImage7 = new Image();
			numberOfShapes(playSurface[6].quantity, cardImage7, cardGrid.col3x, cardGrid.row1y, cardGrid.cardWidth, cardGrid.cardLength, 6);
		}
  };
		
  cardEight = function() {
		if (displayed.card8 === true) { 
			drawCardFrame(selected.card8, cardGrid.col3x, cardGrid.row2y, cardGrid.cardWidth, cardGrid.cardLength);
			let cardImage8 = new Image();
			numberOfShapes(playSurface[7].quantity, cardImage8, cardGrid.col3x, cardGrid.row2y, cardGrid.cardWidth, cardGrid.cardLength, 7);
		}
  };
		
  cardNine = function() {
		if (displayed.card9 === true) { 
			drawCardFrame(selected.card9, cardGrid.col3x, cardGrid.row3y, cardGrid.cardWidth, cardGrid.cardLength);
			let cardImage9 = new Image();
			numberOfShapes(playSurface[8].quantity, cardImage9, cardGrid.col3x, cardGrid.row3y, cardGrid.cardWidth, cardGrid.cardLength, 8);
		}
  };
	
  cardTen = function() {
		if (displayed.card10 === true) { 
			drawCardFrame(selected.card10, cardGrid.col4x, cardGrid.row1y, cardGrid.cardWidth, cardGrid.cardLength);
			let cardImage10 = new Image();
			numberOfShapes(playSurface[9].quantity, cardImage10, cardGrid.col4x, cardGrid.row1y, cardGrid.cardWidth, cardGrid.cardLength, 9);
		}
	};
	
  cardEleven = function() {
		if (displayed.card11 === true) { 
			drawCardFrame(selected.card11, cardGrid.col4x, cardGrid.row2y, cardGrid.cardWidth, cardGrid.cardLength);
			let cardImage11 = new Image();
			numberOfShapes(playSurface[10].quantity, cardImage11, cardGrid.col4x, cardGrid.row2y, cardGrid.cardWidth, cardGrid.cardLength, 10);
		}
  };
			
  cardTwelve = function() {
		if (displayed.card12 === true) { 
			drawCardFrame(selected.card12, cardGrid.col4x, cardGrid.row3y, cardGrid.cardWidth, cardGrid.cardLength);
			let cardImage12 = new Image();
			numberOfShapes(playSurface[11].quantity, cardImage12, cardGrid.col4x, cardGrid.row3y, cardGrid.cardWidth, cardGrid.cardLength, 11);
		}
  };	
	
  cardThirteen = function() {
		if (displayed.card13 === true) { 
			drawCardFrame(selected.card13, cardGrid.col5x, cardGrid.row1y, cardGrid.cardWidth, cardGrid.cardLength);	
			let cardImage13 = new Image();
			numberOfShapes(playSurface[12].quantity, cardImage13, cardGrid.col5x, cardGrid.row1y, cardGrid.cardWidth, cardGrid.cardLength,12);
		}
  };
	
  cardFourteen = function() {
		if (displayed.card14 === true) { 
			drawCardFrame(selected.card14, cardGrid.col5x, cardGrid.row2y, cardGrid.cardWidth, cardGrid.cardLength);
			let cardImage14 = new Image();
			numberOfShapes(playSurface[13].quantity, cardImage14, cardGrid.col5x, cardGrid.row2y, cardGrid.cardWidth, cardGrid.cardLength,13);
		}
  };
	
  cardFifteen = function () {
		if (displayed.card15 === true) { 
			drawCardFrame(selected.card15, cardGrid.col5x, cardGrid.row3y, cardGrid.cardWidth, cardGrid.cardLength);
			let cardImage15 = new Image();
			numberOfShapes(playSurface[14].quantity, cardImage15, cardGrid.col5x, cardGrid.row3y, cardGrid.cardWidth, cardGrid.cardLength,14);
		}
  };
	
// 12 cards should be the standard game, 15 an easier version of the game.
 	
  if (playSurface.length === 15) {
    displayed.card13 = "True";
    displayed.card14 = "True";
	  displayed.card15 = "True";
	  cardThirteen();
	  cardFourteen();
	  cardFifteen();
  };

};  // end of create card function

refreshScreen = function () { 

	drawDeck();
	cardOne();
	cardTwo();	
	cardThree();	
	cardFour();
	cardFive();
	cardSix();
	cardSeven();
	cardEight();
	cardNine();
	cardTen();
	cardEleven();
	cardTwelve();
	if (playSurface.length === 15) {
		cardThirteen();
		cardFourteen();
		cardFifteen();
	};

};	
// Call our Functions
//Create the deck
var masterDeck = createDeck();

//Shuffle the deck
var playDeck = shuffleDeck(masterDeck);

// Deal the cards
var playSurface = createTable(playDeck);

// Make sure we have at least one set to start with
playSurface = startGame(playSurface, playDeck);
// Creating game UI Elements
createGameUI();

createCard(playSurface);

refreshScreen();

// For debug purposes

//  Checking that the playdeck is a shuffled version of the master deck

//var m = 0;

//for (let i = 0; i < playDeck.length; i++) {
//  console.log((m+1) + " " + playDeck[m].symbol + ", "+ playDeck[m].color + ", "+ playDeck[m].shading + ", "+ playDeck[m].quantity);
//  console.log((m+1) + " " + masterDeck[m]);
//  m++;
//}


// Checking that the "dealt" cards are correct
//var n = 0; 
//for (let i = 0; i < playSurface.length; i++) {
    //    		console.log((n+1) + " " + playSurface[n].symbol + ", "+ playSurface[n].color + ", "+ playSurface[n].shading + ", "+ playSurface[n].quantity);
	//				n++;
//			}
//

</script>
</body>
</html>